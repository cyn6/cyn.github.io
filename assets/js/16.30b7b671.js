(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{342:function(a,t,s){"use strict";s.r(t);var n=s(4),e=Object(n.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"浏览器报not-allowed-to-load-local-resource"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#浏览器报not-allowed-to-load-local-resource"}},[a._v("#")]),a._v(" 浏览器报Not allowed to load local resource")]),a._v(" "),t("p",[t("strong",[a._v("1.问题描述")]),a._v("\n浏览器出于安全方面的考虑，禁止网页访问本地文件。\n而实际要访问的是"),t("strong",[a._v("服务器本地")]),a._v("的资源，因此修改"),t("strong",[a._v("服务器")]),a._v("的映射路径。")]),a._v(" "),t("p",[a._v("资源虽然写在src等位置，但都是要发送get请求的，src若是URI其前会拼上当前的ip+端口。")]),a._v(" "),t("p",[t("strong",[a._v("2.解决办法")]),a._v("\n**(1) **如果是tomcat运行的项目（网页在其中），需要配置tomcat虚拟路径：\n把文件存放路径目录映射到tomcat中，方法如下：\na.找到tomcat的配置文件（\\conf\\server.xml）并打开\nb.在【host】与【/host】之间加入：\n"),t("code",[a._v('<Context path="/file" docBase="E:/test" debug="0" reloadable="true"/>')]),a._v("\n其中：【path】就是映射的路径，【docBase】就是你的文件所在路径\nc.调用方法：【E:/test】下有一张test.jpg的图片 【img 标签中的src改为“/file/test.jpg”】")]),a._v(" "),t("p",[a._v("**(2) "),t("strong",[a._v('如果是springboot运行的项目，需要配置内置的tomcat虚拟路径，为项目添加一个配置类：\n【也就是学的放行静态资源访问】\naddResourceHandler("/file/')]),a._v('")：映射的路径。\naddResourceLocations(“file:D:/manager/”)：本地磁盘的路径。')]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Configuration")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("WebMvcConfig")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("implements")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("WebMvcConfigurer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Override")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("addResourceHandlers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ResourceHandlerRegistry")]),a._v(" registry"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        registry"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("addResourceHandler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/file/**"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("addResourceLocations")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"file:D:/manager/"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br")])]),t("blockquote",[t("p",[t("strong",[a._v("上面是路径映射，下面这是路径匹配")]),a._v("\nlocation 用于匹配请求的 URI。URI 表示的是访问路径，除域名和协议以外的内容，比如说我访问了 https://www.lanqiao.cn/louplus/linux，https:// 是协议，www.lanqiao.cn 是域名，/louplus/linux 是 URI。详见"),t("a",{attrs:{href:"https://www.yuque.com/ynch/zy2cus/fb6636f0-508e-4e5a-bc3c-178878ff0028?view=doc_embed",target:"_blank",rel:"noopener noreferrer"}},[a._v("多级缓存设计"),t("OutboundLink")],1)])]),a._v(" "),t("p",[t("strong",[a._v("(3)")]),a._v(" Nginx 静态资源代理配置\n前端访问 "),t("a",{attrs:{href:"http://xn--IP-0p3cm89l",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://你的IP"),t("OutboundLink")],1),a._v(":端口号/user_head/aa.png 就可以访问到在\n/www/wwwroot/xuyijie.icu/upload_file/user_head/ 目录下的aa.png了")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("location /user_head/ {\n\troot /www/wwwroot/xuyijie.icu/upload_file/;\n}\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("p",[a._v("匹配到后就把/user_head/aa.png【URI】加到路径后面去找，路径后的 / 无所谓")]),a._v(" "),t("p",[a._v("而若是转发，\n加末尾加 / 会去掉/api/部分，去请求匹配到的后面的；不加/去请求URI全部；匹配后缀一样是这样")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("location  ^~/api/ {\n    proxy_pass http://localhost:12345;\n}\n\nlocation  ^~/api/ {\n    proxy_pass http://localhost:12345/;\n}\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br")])]),t("h1",{attrs:{id:"解决idea配置tomcat虚拟路径不生效的问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解决idea配置tomcat虚拟路径不生效的问题"}},[a._v("#")]),a._v(" "),t("strong",[a._v("解决idea配置Tomcat虚拟路径不生效的问题")])]),a._v(" "),t("h2",{attrs:{id:"_1-server-xml配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-server-xml配置"}},[a._v("#")]),a._v(" "),t("strong",[a._v("1）server.")]),t("a",{attrs:{href:"https://so.csdn.net/so/search?q=xml&spm=1001.2101.3001.7020",target:"_blank",rel:"noopener noreferrer"}},[a._v("xml"),t("OutboundLink")],1),t("strong",[a._v("配置")])]),a._v(" "),t("p",[a._v("在Tomcat的conf目录下server.xml中配置虚拟路径，在host中加入以下内容\n图片的虚拟路径设置\ndocBase：本地图片的真实路径\npath：在网页中的虚拟路径")]),a._v(" "),t("h2",{attrs:{id:"_2-idea配置-关键"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-idea配置-关键"}},[a._v("#")]),a._v(" "),t("strong",[a._v("2）IDEA配置 (关键)")])]),a._v(" "),t("p",[a._v("在idea中选择Tomcat配置，如下图所示\n"),t("img",{attrs:{src:"https://cdn.statically.io/gh/cyn6/image_storage/master/1679638402114-4b18e0a3-5a0e-49a2-9fc8-039961131ceb.png",alt:"image.png"}})]),a._v(" "),t("h2",{attrs:{id:"_3-重启tomcat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-重启tomcat"}},[a._v("#")]),a._v(" "),t("strong",[a._v("3）重启Tomcat")])]),a._v(" "),t("p",[a._v("通过虚拟路径访问页面")])])}),[],!1,null,null,null);t.default=e.exports}}]);